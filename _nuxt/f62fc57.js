(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{750:function(e,r,t){"use strict";t.r(r);var n=t(26),c=(t(78),t(62),t(5),t(42),t(43),t(510),t(294),t(46),t(12),t(68),{data:function(){return{ready:!0,enableAudio:!1,enableVideo:!0,enablePreview:!0,videoInputType:"screen",devices:[],audioDeviceName:"",videoDeviceName:"",recording:!1,mutePreview:!0,audioStream:null,cameraStream:null,screenStream:null,resultStream:null,recorder:null,chunks:[]}},methods:{selectWindow:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(t=e.screenStream)||void 0===t||t.getTracks().map((function(e){return e.stop()})),null===(n=e.cameraStream)||void 0===n||n.getTracks().map((function(e){return e.stop()})),e.cameraStream=null,r.prev=3,r.next=6,navigator.mediaDevices.getDisplayMedia();case 6:e.screenStream=r.sent,r.next=13;break;case 9:r.prev=9,r.t0=r.catch(3),console.log(r.t0),e.screenStream=null;case 13:e.updatePreview("video");case 14:case"end":return r.stop()}}),r,null,[[3,9]])})))()},updatePreview:function(e){var r=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.enablePreview){t.next=3;break}return r.$refs.preview.srcObject=null,t.abrupt("return");case 3:return t.next=5,r.getResultStream(e);case 5:r.$refs.preview.srcObject=r.resultStream;case 6:case"end":return t.stop()}}),t)})))()},startRecording:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.recording=!0,e.chunks=[],e.recorder=new MediaRecorder(e.resultStream,{mimeType:"video/webm;codecs=vp9"}),e.recorder.ondataavailable=function(r){e.chunks.push(r.data)},e.recorder.onstop=function(){var a=document.createElement("a");a.download="capture.mp4",a.href=URL.createObjectURL(new Blob(e.chunks)),a.click()},e.recorder.start(),e.$bus.$emit("append-msg","Recording started"),console.log(e.recorder.state);case 8:case"end":return r.stop()}}),r)})))()},stopRecording:function(){this.recording=!1,this.recorder.stop(),console.log(this.recorder.state),this.recorder=null},getResultStream:function(e){var r=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var n,c,o,d,l,v,m,f,w,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.refreshDeviceList();case 2:if(!["audio","all"].includes(e)){t.next=11;break}if(null===(d=r.audioStream)||void 0===d||d.getTracks().map((function(e){return e.stop()})),!r.enableAudio){t.next=10;break}return t.next=7,navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:r.devices.filter((function(e){return e.label==r.audioDeviceName}))[0].deviceId}}});case 7:r.audioStream=t.sent,t.next=11;break;case 10:r.audioStream=null;case 11:if(!["video","all"].includes(e)){t.next=30;break}if(!r.enableVideo){t.next=26;break}if("camera"!=r.videoInputType){t.next=22;break}return null===(l=r.cameraStream)||void 0===l||l.getTracks().map((function(e){return e.stop()})),null===(v=r.screenStream)||void 0===v||v.getTracks().map((function(e){return e.stop()})),r.screenStream=null,t.next=19,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:r.devices.filter((function(e){return e.label==r.videoDeviceName}))[0].deviceId}}});case 19:r.cameraStream=t.sent,t.next=24;break;case 22:null===(m=r.cameraStream)||void 0===m||m.getTracks().map((function(e){return e.stop()})),r.cameraStream=null;case 24:t.next=30;break;case 26:null===(f=r.cameraStream)||void 0===f||f.getTracks().map((function(e){return e.stop()})),null===(w=r.screenStream)||void 0===w||w.getTracks().map((function(e){return e.stop()})),r.cameraStream=null,r.screenStream=null;case 30:k=new MediaStream,null===(n=r.audioStream)||void 0===n||n.getTracks().map((function(e){return k.addTrack(e)})),null===(c=r.cameraStream)||void 0===c||c.getTracks().map((function(e){return k.addTrack(e)})),null===(o=r.screenStream)||void 0===o||o.getTracks().map((function(e){return k.addTrack(e)})),r.resultStream=0==k.getTracks().length?null:k;case 35:case"end":return t.stop()}}),t)})))()},refreshDeviceList:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(e.enableAudio||e.enableVideo&&"camera"==e.videoInputType)){r.next=27;break}return(0==e.devices.length||e.devices.some((function(e){return""==e.label})))&&e.$bus.$emit("append-msg","Refreshing device list..."),r.next=4,navigator.mediaDevices.enumerateDevices();case 4:if(!(t=r.sent).some((function(e){return""==e.label}))){r.next=23;break}return r.prev=6,e.ready=!1,r.next=10,navigator.mediaDevices.getUserMedia({audio:e.enableAudio,video:e.enableVideo&&"camera"==e.videoInputType});case 10:return r.sent.getTracks().map((function(e){return e.stop()})),r.next=13,navigator.mediaDevices.enumerateDevices();case 13:t=r.sent,r.next=23;break;case 16:return r.prev=16,r.t0=r.catch(6),e.$bus.$emit("append-msg","Failed to get media devices."),e.enableAudio=!1,e.videoInputType="screen",e.ready=!0,r.abrupt("return");case 23:e.devices=t,e.audioDeviceName||(e.audioDeviceName=e.audioDeviceNames[0]||""),e.videoDeviceName||(e.videoDeviceName=e.videoDeviceNames[0]||""),e.ready=!0;case 27:case"end":return r.stop()}}),r,null,[[6,16]])})))()}},mounted:function(){this.updatePreview()},computed:{audioDeviceNames:function(){return this.devices.filter((function(e){return e.kind.startsWith("audio")})).map((function(e){return e.label}))},videoDeviceNames:function(){return this.devices.filter((function(e){return e.kind.startsWith("video")})).map((function(e){return e.label}))}}}),o=t(61),d=t(66),l=t.n(d),v=t(210),m=t(741),f=t(742),w=t(497),k=t(501),component=Object(o.a)(c,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"mx-3"},[t("div",{staticClass:"d-flex align-center"},[t("v-switch",{attrs:{label:"Audio",inset:"",disabled:e.recording},on:{change:function(r){return e.updatePreview("audio")}},model:{value:e.enableAudio,callback:function(r){e.enableAudio=r},expression:"enableAudio"}}),e._v(" "),t("v-select",{staticClass:"ml-3",attrs:{label:"Captured Audio",items:e.audioDeviceNames,outlined:"",dense:"","hide-details":"",disabled:!e.enableAudio||e.recording},on:{change:function(r){return e.updatePreview("audio")}},model:{value:e.audioDeviceName,callback:function(r){e.audioDeviceName=r},expression:"audioDeviceName"}})],1),e._v(" "),t("div",{staticClass:"d-flex align-center"},[t("v-switch",{attrs:{label:"Video",disabled:e.recording,inset:""},on:{change:function(r){return e.updatePreview("video")}},model:{value:e.enableVideo,callback:function(r){e.enableVideo=r},expression:"enableVideo"}}),e._v(" "),t("v-radio-group",{staticClass:"ml-3",attrs:{row:"",disabled:!e.enableVideo||e.recording},on:{change:function(r){return e.updatePreview("video")}},model:{value:e.videoInputType,callback:function(r){e.videoInputType=r},expression:"videoInputType"}},[t("v-radio",{attrs:{label:"Camera",value:"camera"}}),e._v(" "),t("v-radio",{attrs:{label:"Record Screen",value:"screen"}})],1),e._v(" "),"camera"==e.videoInputType?t("v-select",{attrs:{label:"Captured Video Device",items:e.videoDeviceNames,outlined:"",dense:"","hide-details":"",disabled:!e.enableVideo||e.recording},on:{change:function(r){return e.updatePreview("video")}},model:{value:e.videoDeviceName,callback:function(r){e.videoDeviceName=r},expression:"videoDeviceName"}}):e._e(),e._v(" "),"screen"==e.videoInputType?t("v-btn",{attrs:{disabled:!e.enableVideo||e.recording},on:{click:e.selectWindow}},[e._v("\n      SELECT WINDOW\n    ")]):e._e()],1),e._v(" "),t("div",{staticClass:"d-flex align-center"},[t("v-btn",{attrs:{color:"primary",disabled:e.recording||!e.ready},on:{click:e.startRecording}},[e._v("\n      Start Recording\n    ")]),e._v(" "),t("v-btn",{staticClass:"ml-3",attrs:{disabled:!e.recording},on:{click:e.stopRecording}},[e._v("\n      End Recording\n    ")]),e._v(" "),t("v-switch",{staticClass:"ml-3",attrs:{label:"Preview",inset:"",disabled:!e.ready},on:{change:function(r){return e.updatePreview("all")}},model:{value:e.enablePreview,callback:function(r){e.enablePreview=r},expression:"enablePreview"}}),e._v(" "),t("v-switch",{staticClass:"ml-3",attrs:{label:"Mute Preview",inset:""},model:{value:e.mutePreview,callback:function(r){e.mutePreview=r},expression:"mutePreview"}})],1),e._v(" "),t("video",{directives:[{name:"show",rawName:"v-show",value:e.enablePreview,expression:"enablePreview"}],ref:"preview",staticStyle:{width:"100%"},attrs:{autoplay:""},domProps:{muted:e.mutePreview}})])}),[],!1,null,null,null);r.default=component.exports;l()(component,{VBtn:v.a,VRadio:m.a,VRadioGroup:f.a,VSelect:w.a,VSwitch:k.a})}}]);