(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{636:function(e,t,n){"use strict";n.r(t);var c=n(26),r=(n(77),n(622)),o={data:function(){return{secret:"Omnitrix",showSecret:!1,acceptAllDevices:!1,namePrefix:"Raspi Wifi Manager",loading:!1,device:null,server:null,service:null,char:null,info:{ssid:"",psk:"",currentIp:"",ipIsStatic:!1,staticIp:"",router:"",staticRouter:""},oldInfo:{ssid:"",psk:"",currentIp:"",ipIsStatic:!1,staticIp:"",router:"",staticRouter:""},showPsk:!1,saving:!1,refreshing:!1}},methods:{connect:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n,c,o,filter;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,n=Object(r.a)("discretetom.github.io",r.a.DNS),c=Object(r.a)(e.secret,n),o=Object(r.a)("info",c),filter={},e.acceptAllDevices?filter.acceptAllDevices=!0:filter.namePrefix=e.namePrefix,t.prev=6,t.next=9,navigator.bluetooth.requestDevice({filters:[filter],optionalServices:[c]});case 9:return e.device=t.sent,e.device.addEventListener("gattserverdisconnected",(function(){e.disconnect("Raspi disconnected.")})),e.$bus.$emit("append-msg","Connecting..."),t.next=14,e.device.gatt.connect();case 14:return e.server=t.sent,e.$bus.$emit("append-msg","Getting service..."),t.next=18,e.server.getPrimaryService(c);case 18:return e.service=t.sent,e.$bus.$emit("append-msg","Getting characteristic..."),t.next=22,e.service.getCharacteristic(o);case 22:e.char=t.sent,e.refresh(),t.next=30;break;case 26:t.prev=26,t.t0=t.catch(6),console.log(t.t0),e.disconnect(t.t0);case 30:return t.prev=30,e.loading=!1,t.finish(30);case 33:case"end":return t.stop()}}),t,null,[[6,26,30,33]])})))()},save:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n,c,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.server)&&void 0!==n&&n.connected){t.next=3;break}return e.disconnect("BLE server disconnected."),t.abrupt("return");case 3:return e.saving=!0,t.prev=4,c={SSID:e.info.ssid,PSK:e.info.psk,Static:e.info.ipIsStatic,StaticIP:e.info.staticIp,Router:e.info.staticRouter},r=new TextEncoder,t.next=9,e.char.writeValue(r.encode(JSON.stringify(c)));case 9:e.$bus.$emit("append-msg","Saved."),(!e.info.ipIsStatic&&e.oldInfo.ipIsStatic||e.info.ipIsStatic&&(e.info.staticIp!=e.oldInfo.staticIp||e.info.staticRouter!=e.oldInfo.staticRouter))&&e.disconnect("Raspi will reboot. Disconnected."),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(4),console.log(t.t0),e.disconnect(t.t0);case 17:return t.prev=17,e.saving=!1,t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[4,13,17,20]])})))()},disconnect:function(e){this.$bus.$emit("append-msg",e);try{this.device.gatt.disconnect()}catch(e){}this.device=null,this.server=null},refresh:function(){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var n,c,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.refreshing=!0,t.prev=1,e.$bus.$emit("append-msg","Getting information..."),t.next=5,e.char.readValue();case 5:n=t.sent,c=new TextDecoder("utf-8"),r=JSON.parse(c.decode(n.buffer)),e.info.ssid=r.SSID,e.info.psk=r.PSK,e.info.currentIp=r.CurrentIP,e.info.ipIsStatic=r.Static,e.info.staticIp=r.StaticIP,r.Static?e.info.staticRouter=r.Router:e.info.staticRouter="",e.info.router=r.Router,e.oldInfo=JSON.parse(JSON.stringify(e.info)),e.$bus.$emit("append-msg","Updated."),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(1),e.disconnect(t.t0);case 22:return t.prev=22,e.refreshing=!1,t.finish(22);case 25:case"end":return t.stop()}}),t,null,[[1,19,22,25]])})))()}}},l=n(62),d=n(66),f=n.n(d),v=n(207),h=n(446),m=n(444),x=n(626),S=n(627),I=n(628),k=n(629),w=n(532),P=n(505),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"mb-3"},[n("v-card-title",[e._v(" Bluetooth LE Configurations ")]),e._v(" "),n("v-card-text",[n("v-text-field",{staticClass:"mb-3",attrs:{label:"Secret",type:e.showSecret?"text":"password",outlined:"",dense:"","hide-details":"","append-icon":e.showSecret?"mdi-eye":"mdi-eye-off"},on:{"click:append":function(t){e.showSecret=!e.showSecret}},model:{value:e.secret,callback:function(t){e.secret=t},expression:"secret"}}),e._v(" "),n("v-expansion-panels",{staticClass:"mb-3"},[n("v-expansion-panel",[n("v-expansion-panel-header",[e._v("\n            Additional Settings\n          ")]),e._v(" "),n("v-expansion-panel-content",[n("v-switch",{staticClass:"mb-3",attrs:{label:"Accept All Devices",inset:"","hide-details":""},model:{value:e.acceptAllDevices,callback:function(t){e.acceptAllDevices=t},expression:"acceptAllDevices"}}),e._v(" "),n("v-text-field",{attrs:{disabled:e.acceptAllDevices,label:"Device Name Prefix",outlined:"",dense:"","hide-details":""},model:{value:e.namePrefix,callback:function(t){e.namePrefix=t},expression:"namePrefix"}})],1)],1)],1),e._v(" "),n("v-btn",{attrs:{block:"",loading:e.loading,disabled:null!=e.device},on:{click:e.connect}},[e._v("\n        Connect to Raspi\n      ")])],1)],1),e._v(" "),n("v-card",{attrs:{disabled:null==e.server}},[n("v-card-title",[e._v(" Raspberry Pi ")]),e._v(" "),n("v-card-text",[n("v-text-field",{staticClass:"mb-3",attrs:{label:"Wifi Name",outlined:"",dense:"","hide-details":""},model:{value:e.info.ssid,callback:function(t){e.$set(e.info,"ssid",t)},expression:"info.ssid"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Wifi Password",outlined:"",dense:"","hide-details":"",type:e.showPsk?"text":"password","append-icon":e.showPsk?"mdi-eye":"mdi-eye-off"},on:{"click:append":function(t){e.showPsk=!e.showPsk}},model:{value:e.info.psk,callback:function(t){e.$set(e.info,"psk",t)},expression:"info.psk"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Current IP",outlined:"",dense:"","hide-details":"",disabled:""},model:{value:e.info.currentIp,callback:function(t){e.$set(e.info,"currentIp",t)},expression:"info.currentIp"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Current Router",outlined:"",dense:"","hide-details":"",disabled:""},model:{value:e.info.router,callback:function(t){e.$set(e.info,"router",t)},expression:"info.router"}}),e._v(" "),n("v-switch",{staticClass:"mb-3",attrs:{label:"Use Static IP",inset:"","hide-details":""},model:{value:e.info.ipIsStatic,callback:function(t){e.$set(e.info,"ipIsStatic",t)},expression:"info.ipIsStatic"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Static IP with Prefix Length",outlined:"",dense:"",rules:[function(e){return e.includes("/")&&e.split("/")[1].length>0}],"hide-details":"",disabled:!e.info.ipIsStatic,placeholder:"192.168.0.123/24"},model:{value:e.info.staticIp,callback:function(t){e.$set(e.info,"staticIp",t)},expression:"info.staticIp"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Static Router",outlined:"",dense:"","hide-details":"",disabled:!e.info.ipIsStatic,placeholder:"192.168.0.1"},model:{value:e.info.staticRouter,callback:function(t){e.$set(e.info,"staticRouter",t)},expression:"info.staticRouter"}}),e._v(" "),n("v-btn",{staticClass:"mb-3",attrs:{block:"",loading:e.saving},on:{click:e.save}},[e._v("\n        Save Configuration\n      ")]),e._v(" "),n("v-btn",{attrs:{block:"",loading:e.refreshing},on:{click:e.refresh}},[e._v(" Refresh ")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;f()(component,{VBtn:v.a,VCard:h.a,VCardText:m.b,VCardTitle:m.c,VExpansionPanel:x.a,VExpansionPanelContent:S.a,VExpansionPanelHeader:I.a,VExpansionPanels:k.a,VSwitch:w.a,VTextField:P.a})}}]);