(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{696:function(e,t,n){"use strict";n.r(t);n(14),n(13),n(12),n(16),n(10),n(17);var r=n(89),c=n(2),l=n(26),o=(n(62),n(44),n(553),n(5),n(555),n(561),n(563),n(564),n(565),n(568),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(586),n(587),n(54),n(29),n(80),n(682)),d=n(588);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={data:function(){return{secret:"Omnitrix",showSecret:!1,acceptAllDevices:!1,namePrefix:"BLE Raspi Manager",loading:!1,device:null,server:null,service:null,wifiChar:null,cmdChar:null,wifiStatus:{currentWifi:"",currentIp:"",staticIp:"",router:"",wifis:[],staticRouter:""},oldwifiStatus:{currentWifi:"",currentIp:"",staticIp:"",router:"",wifis:[]},showPsk:!1,saving:!1,refreshingWifi:!1,currentCmd:"",cmdResults:[],bleReadInterval:500}},methods:{connect:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,c,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,n=o.a("discretetom.github.io",o.a.DNS),r=o.a(e.secret,n),c=o.a("wifi",r),l=o.a("cmd",r),d={},e.acceptAllDevices?d.acceptAllDevices=!0:d.filters=[{namePrefix:e.namePrefix}],t.prev=7,t.next=10,navigator.bluetooth.requestDevice(v(v({},d),{},{optionalServices:[r]}));case 10:return e.device=t.sent,e.$bus.$emit("append-msg","Connecting..."),t.next=14,e.device.gatt.connect();case 14:return e.server=t.sent,e.$bus.$emit("append-msg","Getting service..."),t.next=18,e.server.getPrimaryService(r);case 18:return e.service=t.sent,e.$bus.$emit("append-msg","Getting characteristic..."),t.next=22,e.service.getCharacteristic(c);case 22:return e.wifiChar=t.sent,t.next=25,e.service.getCharacteristic(l);case 25:e.cmdChar=t.sent,e.refreshWifi(),t.next=32;break;case 29:t.prev=29,t.t0=t.catch(7),e.disconnect(t.t0);case 32:return t.prev=32,e.loading=!1,t.finish(32);case 35:case"end":return t.stop()}}),t,null,[[7,29,32,35]])})))()},save:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.server)&&void 0!==n&&n.connected){t.next=3;break}return e.disconnect("BLE server disconnected."),t.abrupt("return");case 3:return e.saving=!0,r=[],e.wifiStatus.wifis.map((function(e){return r.push({SSID:e.SSID,PSK:e.PSK})})),c={RefreshOnly:!1,StaticIP:e.wifiStatus.staticIp,Router:e.wifiStatus.staticIp.length>0?e.wifiStatus.staticRouter:"",WIFIs:r},t.prev=7,t.next=10,e.bleWrite(e.wifiChar,d.a(),JSON.stringify(c));case 10:return e.$bus.$emit("append-msg","Saved."),t.next=13,e.refreshWifi();case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(7),e.disconnect(t.t0);case 18:return t.prev=18,e.saving=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[7,15,18,21]])})))()},disconnect:function(e){console.log(e),this.$bus.$emit("append-msg",e);try{this.device.gatt.disconnect()}catch(e){}this.device=null,this.server=null},refreshWifi:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.refreshingWifi=!0,t.prev=1,e.$bus.$emit("append-msg","Getting information..."),n=d.a(),t.next=6,e.bleWrite(e.wifiChar,n,JSON.stringify({RefreshOnly:!0}));case 6:return t.next=8,e.bleRead(e.wifiChar,n);case 8:r=t.sent,c=JSON.parse(r),console.log(c),e.wifiStatus.currentWifi=c.CurrentWIFI,e.wifiStatus.currentIp=c.CurrentIP,e.wifiStatus.router=c.Router,e.wifiStatus.staticIp=c.StaticIP,e.wifiStatus.staticRouter=c.StaticIP.length>0?c.Router:"",e.wifiStatus.wifis=c.WIFIs.map((function(e){return e.showPsk=!1,e})),e.oldwifiStatus=JSON.parse(JSON.stringify(e.wifiStatus)),e.$bus.$emit("append-msg","Updated."),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(1),console.log(t.t0),e.$bus.$emit("append-msg",t.t0);case 25:return t.prev=25,e.refreshingWifi=!1,t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[1,21,25,28]])})))()},runCommand:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=d.a(),r={Cmd:e.currentCmd,UUID:n,loading:!0},e.currentCmd="",e.cmdResults.unshift(r),t.next=6,e.bleWrite(e.cmdChar,n,r.Cmd);case 6:return t.prev=6,t.next=9,e.bleRead(e.cmdChar,n);case 9:c=t.sent,e.cmdResults.map((function(e){e.UUID==r.UUID&&(e.loading=!1,e.Output=c)})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(6),e.cmdResults.map((function(e){e.UUID==r.UUID&&(e.loading=!1,e.Output=t.t0)}));case 16:case"end":return t.stop()}}),t,null,[[6,13]])})))()},bleWrite:function(e,t,content){var n=this;return Object(l.a)(regeneratorRuntime.mark((function r(){var c,l,o,d,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c=new TextEncoder,l=c.encode(t),o=c.encode(content),d=0;case 4:return(f=d+256)>o.byteLength&&(f=o.byteLength),r.next=9,e.writeValue(n.concatBytes(l,o.slice(d,f)));case 9:if(f!=o.byteLength){r.next=11;break}return r.abrupt("break",14);case 11:d=f,r.next=4;break;case 14:return r.next=16,e.writeValue(l);case 16:case"end":return r.stop()}}),r)})))()},bleRead:function(e,t){var n=this;return Object(l.a)(regeneratorRuntime.mark((function r(){var c,l,o,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c=new Uint8Array,l=new TextDecoder("utf-8"),o=36;case 3:return r.next=6,new Promise((function(e){return setTimeout(e,n.bleReadInterval)}));case 6:return r.next=8,e.readValue();case 8:if(d=r.sent,l.decode(d.buffer.slice(0,o))!=t){r.next=15;break}if(d.buffer.byteLength!=o){r.next=12;break}return r.abrupt("return",l.decode(c));case 12:c=n.concatBytes(c,new Uint8Array(d.buffer.slice(o))),r.next=16;break;case 15:throw"Error: Communication was interrupted.";case 16:r.next=3;break;case 18:case"end":return r.stop()}}),r)})))()},concatBytes:function(a,b){return new Uint8Array([].concat(Object(r.a)(a),Object(r.a)(b)))}}},h=n(63),w=n(66),x=n.n(w),S=n(209),C=n(449),k=n(445),I=n(686),_=n(687),y=n(688),R=n(689),P=n(190),O=n(170),D=n(516),W=n(515),component=Object(h.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",{staticClass:"mb-3"},[n("v-card-title",[e._v(" Bluetooth LE Configurations ")]),e._v(" "),n("v-card-text",[n("v-text-field",{staticClass:"mb-3",attrs:{label:"Secret",type:e.showSecret?"text":"password",outlined:"",dense:"","hide-details":"","append-icon":e.showSecret?"mdi-eye":"mdi-eye-off"},on:{"click:append":function(t){e.showSecret=!e.showSecret}},model:{value:e.secret,callback:function(t){e.secret=t},expression:"secret"}}),e._v(" "),n("v-expansion-panels",{staticClass:"mb-3"},[n("v-expansion-panel",[n("v-expansion-panel-header",[e._v("\n            Additional Settings\n          ")]),e._v(" "),n("v-expansion-panel-content",[n("v-switch",{staticClass:"mb-3",attrs:{label:"Accept All Devices",inset:"","hide-details":""},model:{value:e.acceptAllDevices,callback:function(t){e.acceptAllDevices=t},expression:"acceptAllDevices"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{disabled:e.acceptAllDevices,label:"Device Name Prefix",outlined:"",dense:"","hide-details":""},model:{value:e.namePrefix,callback:function(t){e.namePrefix=t},expression:"namePrefix"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Read Interval for Long Content (ms)",outlined:"",dense:"","hide-details":"",type:"number"},model:{value:e.bleReadInterval,callback:function(t){e.bleReadInterval=t},expression:"bleReadInterval"}})],1)],1)],1),e._v(" "),n("v-btn",{attrs:{block:"",loading:e.loading,disabled:null!=e.device},on:{click:e.connect}},[e._v("\n        Connect to Raspi\n      ")])],1)],1),e._v(" "),n("v-card",{staticClass:"mb-3",attrs:{disabled:null==e.wifiChar}},[n("v-card-title",[e._v(" Raspberry Pi Network ")]),e._v(" "),n("v-card-text",[n("v-text-field",{staticClass:"mb-3",attrs:{label:"Connected Wifi",outlined:"",dense:"","hide-details":"",disabled:""},model:{value:e.wifiStatus.currentWifi,callback:function(t){e.$set(e.wifiStatus,"currentWifi",t)},expression:"wifiStatus.currentWifi"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Current IP",outlined:"",dense:"","hide-details":"",disabled:""},model:{value:e.wifiStatus.currentIp,callback:function(t){e.$set(e.wifiStatus,"currentIp",t)},expression:"wifiStatus.currentIp"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Current Router",outlined:"",dense:"","hide-details":"",disabled:""},model:{value:e.wifiStatus.router,callback:function(t){e.$set(e.wifiStatus,"router",t)},expression:"wifiStatus.router"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Static IP with Prefix Length",outlined:"",dense:"",rules:[function(e){return e.includes("/")&&e.split("/")[1].length>0}],"hide-details":"",placeholder:"192.168.0.123/24"},model:{value:e.wifiStatus.staticIp,callback:function(t){e.$set(e.wifiStatus,"staticIp",t)},expression:"wifiStatus.staticIp"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3",attrs:{label:"Static Router",outlined:"",dense:"",disabled:!e.wifiStatus.staticIp,"hide-details":"",placeholder:"192.168.0.1"},model:{value:e.wifiStatus.staticRouter,callback:function(t){e.$set(e.wifiStatus,"staticRouter",t)},expression:"wifiStatus.staticRouter"}}),e._v(" "),n("v-card",{staticClass:"mb-3"},[n("v-card-title",[e._v("WIFIs")]),e._v(" "),n("v-card-text",[e._l(e.wifiStatus.wifis,(function(t,i){return n("div",{key:i,staticClass:"d-flex mb-3"},[n("v-text-field",{staticClass:"mb-3",attrs:{label:"SSID",outlined:"",dense:"","hide-details":""},model:{value:t.SSID,callback:function(n){e.$set(t,"SSID",n)},expression:"wifi.SSID"}}),e._v(" "),n("v-text-field",{staticClass:"mb-3 mx-3",attrs:{label:"PSK",outlined:"",dense:"","hide-details":"",type:t.showPsk?"text":"password","append-icon":t.showPsk?"mdi-eye":"mdi-eye-off"},on:{"click:append":function(e){t.showPsk=!t.showPsk}},model:{value:t.PSK,callback:function(n){e.$set(t,"PSK",n)},expression:"wifi.PSK"}}),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.wifiStatus.wifis.pop(i)}}},[n("v-icon",[e._v("mdi-close")])],1)],1)})),e._v(" "),n("v-btn",{staticClass:"mb-3",attrs:{block:""},on:{click:function(t){return e.wifiStatus.wifis.push({SSID:"",PSK:"",showPsk:!1})}}},[e._v("\n            Add WIFI\n          ")])],2)],1),e._v(" "),n("v-btn",{staticClass:"mb-3",attrs:{block:"",loading:e.saving},on:{click:e.save}},[e._v("\n        Save Configuration\n      ")]),e._v(" "),n("v-btn",{attrs:{block:"",loading:e.refreshingWifi},on:{click:e.refreshWifi}},[e._v("\n        Refresh\n      ")])],1)],1),e._v(" "),n("v-card",{staticClass:"mb-3",attrs:{disabled:null==e.cmdChar}},[n("v-card-title",[e._v(" Run Commands ")]),e._v(" "),n("v-card-text",[n("div",{staticClass:"d-flex align-center mb-3"},[n("v-text-field",{staticClass:"mr-3",attrs:{label:"Shell Command",placeholder:"echo 123",outlined:"",dense:"","hide-details":""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.runCommand.apply(null,arguments)}},model:{value:e.currentCmd,callback:function(t){e.currentCmd=t},expression:"currentCmd"}}),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:e.runCommand}},[n("v-icon",[e._v("mdi-check")])],1)],1),e._v(" "),n("v-expansion-panels",e._l(e.cmdResults,(function(t,i){return n("v-expansion-panel",{key:t.UUID},[n("v-card",[n("v-card-title",{staticClass:"d-flex align-center"},[n("div",{staticClass:"flex-grow-1"},[e._v("\n                "+e._s(t.Cmd)+"\n              ")]),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.cmdResults.pop(i)}}},[n("v-icon",[e._v("mdi-close")])],1)],1),e._v(" "),n("v-card-subtitle",[e._v("UUID: "+e._s(t.UUID))]),e._v(" "),n("v-card-text",{staticStyle:{overflow:"auto"}},[n("pre",[e._v(e._s(t.Output))]),e._v(" "),t.loading?n("v-progress-circular",{attrs:{indeterminate:""}}):e._e()],1)],1)],1)})),1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;x()(component,{VBtn:S.a,VCard:C.a,VCardSubtitle:k.a,VCardText:k.b,VCardTitle:k.c,VExpansionPanel:I.a,VExpansionPanelContent:_.a,VExpansionPanelHeader:y.a,VExpansionPanels:R.a,VIcon:P.a,VProgressCircular:O.a,VSwitch:D.a,VTextField:W.a})}}]);